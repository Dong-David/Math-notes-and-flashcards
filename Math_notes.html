<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ghi chÃº ToÃ¡n há»c</title>
    <link rel="stylesheet" href="style.css">

    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

    <!-- math.js -->
    <script src="https://cdn.jsdelivr.net/npm/mathjs@11/lib/browser/math.js"></script>
</head>

<body>
    <div class="background"></div>

    <h1>Ghi chÃº ToÃ¡n há»c</h1>
    <button onclick="toggleTheme()">ğŸŒ— Äá»•i ná»n SÃ¡ng/Tá»‘i</button>
    <button onclick="handleSave()">ğŸ’¾ LÆ°u vÃ  xem</button>
    <button onclick="clearNotes()">ğŸ—‘ï¸ XÃ³a ghi chÃº</button>
    <p><strong>Máº¹o:</strong> Gáº¡ch Ä‘áº§u dÃ²ng báº±ng <code>-</code>, <code>*</code> hoáº·c <code>â€¢</code>. Ghi chÃº phá»¥ náº±m ngay
        dÆ°á»›i cÃ´ng thá»©c.</p>

    <textarea id="noteInput" placeholder="VÃ­ dá»¥:
    - Äá»‹nh lÃ½ Pythagore: $a^2 + b^2 = c^2$
    Ãp dá»¥ng khi tam giÃ¡c vuÃ´ng, cáº¡nh c lÃ  cáº¡nh huyá»n.

    - Diá»‡n tÃ­ch: $S = \frac{1}{2}ab\sin(C)$
    - TÃ­nh toÃ¡n: $2^4 + \sqrt{16} + \log_{10}(100)$"></textarea>

    <div id="output"></div>

    <div id="helpControls" style="margin-top: 10px;">
        ğŸ” <input type="text" id="helpSearch" placeholder="TÃ¬m tá»« khÃ³a..." style="padding: 4px; width: 200px;" />
        <button onclick="toggleAllDetails(true)">Má»Ÿ táº¥t cáº£</button>
        <button onclick="toggleAllDetails(false)">Thu gá»n táº¥t cáº£</button>
    </div>

    <button onclick="toggleHelp()">ğŸ“˜ Gá»£i Ã½ kÃ½ hiá»‡u</button>
    <div id="helpBox" style="
        display: none;
        margin-top: 10px;
        border: 1px solid #ccc;
        padding: 10px;
        max-height: 300px;          /* Giá»›i háº¡n chiá»u cao */
        overflow-y: auto;           /* Tá»± Ä‘á»™ng cuá»™n dá»c khi trÃ n */
        background-color: #f3f3f3;
        border-radius: 6px;
    ">
        <details open>
            <summary>ğŸ“ I. Äáº¡i sá»‘ â€“ Giáº£i tÃ­ch <small>(bÃ¬nh phÆ°Æ¡ng, cÄƒn, Ä‘áº¡o hÃ m, tÃ­ch phÃ¢n...)</small></summary>
            <ul>
                <li><code>$a^2$</code> â†’ a bÃ¬nh phÆ°Æ¡ng</li>
                <li><code>$\sqrt{x}$</code> â†’ cÄƒn báº­c hai cá»§a x</li>
                <li><code>$\sqrt[3]{x}$</code> â†’ cÄƒn báº­c ba cá»§a x</li>
                <li><code>$(a + b)^2 = a^2 + 2ab + b^2$</code> â†’ háº±ng Ä‘áº³ng thá»©c</li>
                <li><code>$f(x)$</code> â†’ hÃ m sá»‘ f táº¡i x</li>
                <li><code>$f'(x)$</code> â†’ Ä‘áº¡o hÃ m cá»§a f</li>
                <li><code>$\lim_{x \to a} f(x)$</code> â†’ giá»›i háº¡n cá»§a f(x) khi x â†’ a</li>
                <li><code>$\int_a^b f(x)\,dx$</code> â†’ tÃ­ch phÃ¢n tá»« a Ä‘áº¿n b</li>
                <li><code>$\frac{dy}{dx}$</code> â†’ Ä‘áº¡o hÃ m vi phÃ¢n</li>
                <li><code>$x \in \mathbb{R}$</code> â†’ x thuá»™c táº­p sá»‘ thá»±c</li>
                <li><code>$x \notin A$</code> â†’ x khÃ´ng thuá»™c táº­p A</li>
                <li><code>$\log x$</code> â†’ logarit cÆ¡ sá»‘ 10 cá»§a x</li>
                <li><code>$\ln x$</code> â†’ logarit tá»± nhiÃªn</li>
                <li><code>$e^x$</code> â†’ hÃ m mÅ©</li>
                <li><code>$\sin x$, $\cos x$, $\tan x$</code> â†’ cÃ¡c hÃ m lÆ°á»£ng giÃ¡c</li>
                <li><code>$|x|$</code> â†’ giÃ¡ trá»‹ tuyá»‡t Ä‘á»‘i</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ”¢ II. Tá»• há»£p â€“ Rá»i ráº¡c <small>(giai thá»«a, tá»• há»£p, tá»•ng, giao â€“ há»£p)</small></summary>
            <ul>
                <li><code>$\binom{n}{k}$</code> â†’ tá»• há»£p C(n, k)</li>
                <li><code>$n!$</code> â†’ giai thá»«a</li>
                <li><code>$2^n$</code> â†’ sá»‘ táº­p con</li>
                <li><code>$\sum_{i=1}^n a_i$</code> â†’ tá»•ng tá»« i=1 Ä‘áº¿n n</li>
                <li><code>$\prod_{i=1}^n a_i$</code> â†’ tÃ­ch tá»« i=1 Ä‘áº¿n n</li>
                <li><code>$P(A)$</code> â†’ táº­p táº¥t cáº£ táº­p con cá»§a A</li>
                <li><code>$A \cup B$</code> â†’ há»£p cá»§a A vÃ  B</li>
                <li><code>$A \cap B$</code> â†’ giao cá»§a A vÃ  B</li>
                <li><code>$A \setminus B$</code> â†’ A trá»« B</li>
                <li><code>$n^k$</code> â†’ sá»‘ chá»‰nh há»£p láº·p</li>
                <li><code>$[x]$</code> â†’ pháº§n nguyÃªn cá»§a x</li>
                <li><code>$\lfloor x \rfloor$</code>, <code>$\lceil x \rceil$</code> â†’ floor, ceil</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ§  III. Logic â€“ Má»‡nh Ä‘á» <small>(vÃ , hoáº·c, suy ra, Ä‘Ãºng/sai)</small></summary>
            <ul>
                <li><code>$p \Rightarrow q$</code> â†’ náº¿u p thÃ¬ q</li>
                <li><code>$p \Leftrightarrow q$</code> â†’ p tÆ°Æ¡ng Ä‘Æ°Æ¡ng q</li>
                <li><code>$\neg p$</code> â†’ phá»§ Ä‘á»‹nh p</li>
                <li><code>$p \land q$</code> â†’ p vÃ  q</li>
                <li><code>$p \lor q$</code> â†’ p hoáº·c q</li>
                <li><code>$T$, $F$</code> â†’ ÄÃºng, Sai</li>
                <li><code>$\oplus$</code> â†’ XOR (hoáº·c loáº¡i trá»«)</li>
                <li><code>$\therefore$</code> â†’ do Ä‘Ã³</li>
                <li><code>$\because$</code> â†’ bá»Ÿi vÃ¬</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ”— IV. Táº­p há»£p <small>(táº­p con, táº­p há»£p, âˆˆ, âˆ‰, âˆª, âˆ©)</small></summary>
            <ul>
                <li><code>$x \in A$</code> â†’ x thuá»™c táº­p A</li>
                <li><code>$x \notin A$</code> â†’ x khÃ´ng thuá»™c A</li>
                <li><code>$A \subset B$</code> â†’ A lÃ  táº­p con cá»§a B</li>
                <li><code>$A \subseteq B$</code> â†’ A lÃ  táº­p con hoáº·c báº±ng B</li>
                <li><code>$A \times B$</code> â†’ tÃ­ch Descartes</li>
                <li><code>$\forall x \in A$</code> â†’ vá»›i má»i x thuá»™c A</li>
                <li><code>$\exists x$</code> â†’ tá»“n táº¡i x</li>
                <li><code>$\emptyset$</code> â†’ táº­p rá»—ng</li>
                <li><code>$\mathbb{N}, \mathbb{Z}, \mathbb{Q}, \mathbb{R}, \mathbb{C}$</code> â†’ táº­p sá»‘ tá»± nhiÃªn, nguyÃªn,
                    há»¯u tá»‰, thá»±c, phá»©c</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ§® V. HÃ m â€“ Ãnh xáº¡ <small>(hÃ m ngÆ°á»£c, hÃ m há»£p, Ã¡nh xáº¡)</small></summary>
            <ul>
                <li><code>$f: A \to B$</code> â†’ Ã¡nh xáº¡ tá»« A Ä‘áº¿n B</li>
                <li><code>$f^{-1}(y)$</code> â†’ giÃ¡ trá»‹ ngÆ°á»£c cá»§a y</li>
                <li><code>$f \circ g$</code> â†’ hÃ m há»£p</li>
                <li><code>$f^{-1}$</code> â†’ Ã¡nh xáº¡ ngÆ°á»£c</li>
                <li><code>$\text{dom }f$, $\text{ran }f$</code> â†’ táº­p xÃ¡c Ä‘á»‹nh, táº­p giÃ¡ trá»‹</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ“Š VI. Äá»“ thá»‹ â€“ Tin há»c <small>(Ä‘á»‰nh, cáº¡nh, Ä‘á»“ thá»‹, cÃ¢y, chu trÃ¬nh)</small></summary>
            <ul>
                <li><code>$G = (V, E)$</code> â†’ Ä‘á»“ thá»‹ G</li>
                <li><code>$deg(v)$</code> â†’ báº­c Ä‘á»‰nh v</li>
                <li><code>$u \sim v$</code> â†’ u vÃ  v ká» nhau</li>
                <li><code>$u \leftrightarrow v$</code> â†’ cÃ³ Ä‘Æ°á»ng Ä‘i tá»« u tá»›i v</li>
                <li><code>$C_n$</code> â†’ chu trÃ¬nh n Ä‘á»‰nh</li>
                <li><code>$K_n$</code> â†’ Ä‘á»“ thá»‹ Ä‘áº§y Ä‘á»§</li>
                <li><code>$T$</code> â†’ cÃ¢y</li>
                <li><code>$d(u,v)$</code> â†’ Ä‘á»™ dÃ i Ä‘Æ°á»ng Ä‘i ngáº¯n nháº¥t</li>
                <li><code>$|V|$, $|E|$</code> â†’ sá»‘ Ä‘á»‰nh, sá»‘ cáº¡nh</li>
                <li><code>$Adj(u)$</code> â†’ táº­p Ä‘á»‰nh ká»</li>
                <li><code>$\delta(v)$</code> â†’ báº­c vÃ o/ra (Ä‘á»“ thá»‹ cÃ³ hÆ°á»›ng)</li>
            </ul>
        </details>

        <details>
            <summary>ğŸ“ VII. HÃ¬nh há»c <small>(tam giÃ¡c, gÃ³c, vuÃ´ng gÃ³c, song song)</small></summary>
            <ul>
                <li><code>$\triangle ABC$</code> â†’ tam giÃ¡c ABC</li>
                <li><code>$\angle A$</code> â†’ gÃ³c A</li>
                <li><code>$AB \perp CD$</code> â†’ vuÃ´ng gÃ³c</li>
                <li><code>$AB \parallel CD$</code> â†’ song song</li>
                <li><code>$S_{\triangle}$</code> â†’ diá»‡n tÃ­ch tam giÃ¡c</li>
                <li><code>$R$, $r$</code> â†’ bÃ¡n kÃ­nh Ä‘Æ°á»ng trÃ²n ngoáº¡i tiáº¿p/ná»™i tiáº¿p</li>
                <li><code>$O$</code> â†’ tÃ¢m Ä‘Æ°á»ng trÃ²n</li>
                <li><code>$d$</code> â†’ khoáº£ng cÃ¡ch giá»¯a hai Ä‘iá»ƒm hoáº·c Ä‘iá»ƒm vÃ  Ä‘Æ°á»ng</li>
            </ul>

        </details>

        <script>
            function toggleHelp() {
                const box = document.getElementById('helpBox');
                const isShown = box.style.display === 'none';
                box.style.display = isShown ? 'block' : 'none';

                if (isShown && window.MathJax) {
                    MathJax.typeset();
                }
            }

            function toggleAllDetails(expand) {
                const sections = document.querySelectorAll("#helpBox details");
                sections.forEach(sec => sec.open = expand);
            }

            document.getElementById("helpSearch").addEventListener("input", function () {
                const keyword = this.value.toLowerCase();
                const helpBox = document.getElementById("helpBox");
                const details = helpBox.querySelectorAll("details");

                let found = false;
                details.forEach(section => {
                    const text = section.innerText.toLowerCase();
                    if (text.includes(keyword)) {
                        section.open = true;
                        if (!found) {
                            section.scrollIntoView({ behavior: "smooth", block: "start" });
                            found = true;
                        }
                    } else {
                        section.open = false;
                    }
                });

                if (!found && keyword.length > 0) {
                    alert("â— KhÃ´ng tÃ¬m tháº¥y tá»« khÃ³a: " + keyword);
                }
            });

            function toggleTheme() {
                const isDark = document.body.classList.toggle("dark");
                localStorage.setItem("theme", isDark ? "dark" : "light");
            }

            function clearNotes() {
                localStorage.removeItem("mathNote");
                document.getElementById("noteInput").value = "";
                document.getElementById("output").innerHTML = "";
            }

            function convertToHTML(text) {
                const lines = text.split("\n");
                let html = "<ul>";

                for (let i = 0; i < lines.length; ++i) {
                    let trimmed = lines[i].trim();

                    const mathExprMatch = trimmed.match(/\$(.+?)\$/);
                    if (mathExprMatch) {
                        try {
                            let rawExpr = mathExprMatch[1]
                                .replace(/\\sqrt{(.+?)}/g, 'sqrt($1)')
                                .replace(/\\frac{(.+?)}{(.+?)}/g, '($1)/($2)')
                                .replace(/\\log_{10}\((.+?)\)/g, 'log10($1)')
                                .replace(/\\log\((.+?)\)/g, 'log($1)');

                            const result = math.evaluate(rawExpr);
                            if (!isNaN(result)) {
                                trimmed += ` <span class="subnote">= ${result}</span>`;
                            }
                        } catch (e) {
                            console.warn("KhÃ´ng thá»ƒ tÃ­nh toÃ¡n:", e);
                        }
                    }

                    if (/^[-*â€¢]/.test(trimmed)) {
                        html += `<li>${trimmed.slice(1).trim()}`;
                        const nextLine = lines[i + 1]?.trim();
                        if (nextLine && !/^[-*â€¢]/.test(nextLine)) {
                            html += `<div class="subnote">${nextLine}</div>`;
                            ++i;
                        }
                        html += "</li>";
                    } else if (trimmed) {
                        html += `<li style="list-style-type:none">${trimmed}</li>`;
                    }
                }

                html += "</ul>";
                return html;
            }

            function updatePreview(text = null) {
                const input = document.getElementById("noteInput");
                const content = text ?? input.value;
                const output = document.getElementById("output");

                localStorage.setItem("mathNote", content);
                output.innerHTML = convertToHTML(content);

                if (window.MathJax && MathJax.typesetPromise) {
                    MathJax.typesetPromise().then(() => {
                        output.scrollTop = output.scrollHeight;
                    });
                }
            }

            function handleSave() {
                updatePreview();
                alert("ğŸ“Œ ÄÃ£ lÆ°u ghi chÃº!");
            }

            window.onload = function () {
                const savedNote = localStorage.getItem("mathNote");
                if (savedNote) {
                    document.getElementById("noteInput").value = savedNote;
                    updatePreview(savedNote);
                }

                const savedTheme = localStorage.getItem("theme");
                if (savedTheme === "dark") {
                    document.body.classList.add("dark");
                }

                document.getElementById("noteInput").addEventListener("input", () => updatePreview());
            };
        </script>
</body>

</html>
